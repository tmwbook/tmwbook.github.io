<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="site.css">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link href="https://fonts.googleapis.com/css2?family=Lato:300,400" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mustache.js/4.1.0/mustache.js" integrity="sha512-SDpqS2G7Z70bGQSl26nhAdQj9YJoQqMOJVBVqE1EyEaAAzdvLFNZ0R06FzBu+E8xTcmbd2dBhvBJuJrbEUiKqA==" crossorigin="anonymous"></script>
    <title>Thomas White</title>
</head>
<body class="container text-light">
    <nav class="navbar navbar-expand-xl border-bottom border-1">
        <div class="container-fluid">
            <a href="index.html" class="navbar-brand link-light">Tom White</a>
        </div>
    </nav>
    <!--<img class="rounded-circle"src="https://avatars3.githubusercontent.com/u/5827837?s=400&u=6c9268714f45b733bc62a8a3e6429ae86fd686e7&v=4"> -->
    <div class="container" style="padding-top: 5em;">
        <div class="row">
            <div class="col">
                <div class="card bg-dark border border-custom-light h-100" id="github">
                    <a href="https://github.com/tmwbook" target="_blank" class="text-decoration-none text-reset">
                    <div class="card-body text-center">
                        <img class="style-logo" src="GitHub-Mark.svg">
                    </div>
                    </a>
                    <template id="inner-content-card-template">
                        <a href="{{ slice_link }}" target="_blank" class="text-decoration-none text-reset">
                        <div class="list-group-item inner-content-card bg-dark border border-custom-light mx-auto">
                            <h4>{{ header }}</h4>
                            <p class="card-text">{{ description }}</p>
                        </div>
                        </a>
                    </template>
                </div>
            </div>
            <div class="col">
                <div class="card bg-dark border border-custom-light h-100" id="medium">
                    <a href="https://tomwhite-40233.medium.com/" target="_blank" class="text-decoration-none text-reset">
                    <div class="card-body text-center">
                        <img class="style-logo" src="Artboard 1 trimmed.svg">
                    </div>
                    </a>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // TODO look into GraphQL API for pinned repos
        let template = document.querySelector("#inner-content-card-template")

        fetch("https://api.github.com/users/tmwbook/repos")
        .then((resp) => {
            return resp.json()
        })
        .then((data) => {
            data.sort((a,b) => (new Date(a.updated_at) > new Date(b.updated_at) ? -1 : 1))
            let latest = data.slice(0, 5)
            let github_section = document.querySelector("#github")

            latest.forEach((repo) => {
                github_section.insertAdjacentHTML("beforeend", Mustache.render(template.innerHTML, {
                    slice_link: repo.html_url,
                    header: repo.full_name,
                    description: repo.description || `Primary language: ${repo.language}`
                }))
            })
        })

        fetch("https://api.rss2json.com/v1/api.json?rss_url=https%3A%2F%2Fmedium.com%2Ffeed%2F%40tomwhite-40233")
        .then((resp) => resp.json())
        .then((data) => {
            let articles = data.items
            let latest = articles.slice(0, 5)
            let medium_section = document.querySelector("#medium")

            latest.forEach((article) => {
                medium_section.insertAdjacentHTML("beforeend", Mustache.render(template.innerHTML, {
                    slice_link: article.guid,
                    header: article.title,
                    description: `Categories: ${article.categories.join(", ")}`
                }))
            })
        })
    </script>
</body>
</html>